#!/bin/bash

if ! docker info > /dev/null 2>&1; then 
    echo 'Docker is not running.' 
    exit 1 
fi

echo "ZIPping Task A..."
cd TaskA;zip TaskA.zip -r .;mv TaskA.zip ..;cd ..
echo "...done."

echo "Deploying Task A..."
curl -X PUT http://localhost:8000/taska \
     -H "Content-Type: multipart/form-data" \
     -F "zip_file=@TaskA.zip"                      
echo -e "\n"

echo "ZIPping Task B..."
cd TaskB;zip TaskB.zip -r .;mv TaskB.zip ..;cd ..;
echo "...done."

echo "Deploying Task B..."
curl -X PUT http://localhost:8000/taskb \
     -H "Content-Type: multipart/form-data" \
     -F "zip_file=@TaskB.zip"
echo -e "\n"

# Invoke Task A (Task A has no args)
#curl -X POST http://localhost:8000/taska